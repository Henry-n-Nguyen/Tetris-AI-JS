<html>
  <head>
    <link
      href="https://fonts.googleapis.com/css?family=Press+Start+2P"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="grid">
      <canvas
        id="canvas"
        width="350"
        height="700"
        style="border: 2px solid"
      ></canvas>
      <div class="right-column">
        <div style="display: flex; flex-direction: row">
          <canvas
            id="choices"
            width="120"
            height="380"
            style="border: 2px solid"
          ></canvas>
          <div
            style="
              padding: 30px 20px;
              display: flex;
              flex-direction: column;
              justify-content: space-between;
            "
          >
            <button onclick="addLineShape()">Add</button>
            <button onclick="addSquareShape()">Add</button>
            <button onclick="addLShape()">Add</button>
            <button onclick="addMirrorLShape()">Add</button>
            <button onclick="addZShape()">Add</button>
            <button onclick="addTShape()">Add</button>
          </div>
        </div>
        <button onclick="play()" class="play-button">Play</button>
      </div>
    </div>

    <script>
      // canvas
      let canvas = document.getElementById("canvas");
      let canvasWidth = 350;
      let canvasHeight = 700;
      let ctx = canvas.getContext("2d");
      ctx.fillStyle = "blue";

      //   ctx.fillRect(x, y, width, height);
      pixel = {
        width: canvasWidth / 10,
        height: canvasHeight / 20,
      };

      // set paths
      let timeOut;

      // move paths
      let block = [];

      function move() {
        for (let i = 0; i < block.length; i++) {
          ctx.clearRect(
            block[i].x * pixel.width,
            block[i].y * pixel.height,
            pixel.width,
            pixel.height
          );

          block[i].y++;

          ctx.fillStyle = "black";
          ctx.fillRect(
            block[i].x * pixel.width,
            block[i].y * pixel.height,
            pixel.width,
            pixel.height
          );

          ctx.fillStyle = block[i].color;
          ctx.fillRect(
            block[i].x * pixel.width + 0.5,
            block[i].y * pixel.height + 0.5,
            pixel.width - 1,
            pixel.height - 1
          );
        }

        for (let i = 0; i < block.length; i++) {
          if (block[i].y == 19) {
            console.clear();
            clearTimeout(timeOut);
            play();
          }
        }

        origin = performance.now();
        timeOut = setTimeout(move, 500);
        console.log(performance.now() - origin);
      }

      // choices_block
      let choices = document.getElementById("choices");
      let cb = choices.getContext("2d");

      drawChoices();

      function drawChoices() {
        // Line shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 10, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 10.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 20, 20, 20);

        cb.fillStyle = "#4deeea";
        cb.fillRect(20.5, 20.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 20, 20, 20);

        cb.fillStyle = "#4deeea";
        cb.fillRect(40.5, 20.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(60, 20, 20, 20);

        cb.fillStyle = "#4deeea";
        cb.fillRect(60.5, 20.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(80, 20, 20, 20);

        cb.fillStyle = "#4deeea";
        cb.fillRect(80.5, 20.5, 19, 19);

        // Square shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 70, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 70.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 80, 20, 20);

        cb.fillStyle = "#ffe700";
        cb.fillRect(20.5, 80.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 80, 20, 20);

        cb.fillStyle = "#ffe700";
        cb.fillRect(40.5, 80.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(20, 100, 20, 20);

        cb.fillStyle = "#ffe700";
        cb.fillRect(20.5, 100.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(40, 100, 20, 20);

        cb.fillStyle = "#ffe700";
        cb.fillRect(40.5, 100.5, 19, 19);

        // L-shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 130, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 130.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 160, 20, 20);

        cb.fillStyle = "#ff971c";
        cb.fillRect(20.5, 160.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 160, 20, 20);

        cb.fillStyle = "#ff971c";
        cb.fillRect(40.5, 160.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(60, 160, 20, 20);

        cb.fillStyle = "#ff971c";
        cb.fillRect(60.5, 160.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(60, 140, 20, 20);

        cb.fillStyle = "#ff971c";
        cb.fillRect(60.5, 140.5, 19, 19);

        // MirrorL-shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 190, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 190.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 220, 20, 20);

        cb.fillStyle = "#0077d3";
        cb.fillRect(20.5, 220.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 220, 20, 20);

        cb.fillStyle = "#0077d3";
        cb.fillRect(40.5, 220.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(60, 220, 20, 20);

        cb.fillStyle = "#0077d3";
        cb.fillRect(60.5, 220.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(20, 200, 20, 20);

        cb.fillStyle = "#0077d3";
        cb.fillRect(20.5, 200.5, 19, 19);

        // Z-shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 250, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 250.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 280, 20, 20);

        cb.fillStyle = "#53da3f";
        cb.fillRect(20.5, 280.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 260, 20, 20);

        cb.fillStyle = "#53da3f";
        cb.fillRect(40.5, 260.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(40, 280, 20, 20);

        cb.fillStyle = "#53da3f";
        cb.fillRect(40.5, 280.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(60, 260, 20, 20);

        cb.fillStyle = "#53da3f";
        cb.fillRect(60.5, 260.5, 19, 19);

        // T-shapes

        cb.fillStyle = "black";
        cb.fillRect(10, 310, 100, 60);

        cb.fillStyle = "white";
        cb.fillRect(10.5, 310.5, 99, 59);

        // #1
        cb.fillStyle = "black";
        cb.fillRect(20, 340, 20, 20);

        cb.fillStyle = "#f000ff";
        cb.fillRect(20.5, 340.5, 19, 19);

        // #2
        cb.fillStyle = "black";
        cb.fillRect(40, 320, 20, 20);

        cb.fillStyle = "#f000ff";
        cb.fillRect(40.5, 320.5, 19, 19);

        // #3
        cb.fillStyle = "black";
        cb.fillRect(40, 340, 20, 20);

        cb.fillStyle = "#f000ff";
        cb.fillRect(40.5, 340.5, 19, 19);

        // #4
        cb.fillStyle = "black";
        cb.fillRect(60, 340, 20, 20);

        cb.fillStyle = "#f000ff";
        cb.fillRect(60.5, 340.5, 19, 19);
      }

      function addLineShape() {
        block = [];

        // #1
        block.push({
          color: "#4deeea",
          x: 3,
          y: -1,
        });

        // #2
        block.push({
          color: "#4deeea",
          x: 4,
          y: -1,
        });

        // #3
        block.push({
          color: "#4deeea",
          x: 5,
          y: -1,
        });

        // #4
        block.push({
          color: "#4deeea",
          x: 6,
          y: -1,
        });

        move();
      }

      function addSquareShape() {
        block = [];

        // #1
        block.push({
          color: "#ffe700",
          x: 4,
          y: -1,
        });

        // #2
        block.push({
          color: "#ffe700",
          x: 5,
          y: -1,
        });

        // #3
        block.push({
          color: "#ffe700",
          x: 4,
          y: -2,
        });

        // #4
        block.push({
          color: "#ffe700",
          x: 5,
          y: -2,
        });

        move();
      }
      
      function addLShape() {
        block = [];

        // #1
        block.push({
          color: "#ff971c",
          x: 4,
          y: -1,
        });

        // #2
        block.push({
          color: "#ff971c",
          x: 5,
          y: -1,
        });

        // #3
        block.push({
          color: "#ff971c",
          x: 4,
          y: -2,
        });

        // #4
        block.push({
          color: "#ff971c",
          x: 4,
          y: -3,
        });

        move();
      }
    
      function addMirrorLShape() {
        block = [];

        // #1
        block.push({
          color: "#0077d3",
          x: 4,
          y: -1,
        });

        // #2
        block.push({
          color: "#0077d3",
          x: 4,
          y: -2,
        });

        // #3
        block.push({
          color: "#0077d3",
          x: 4,
          y: -3,
        });

        // #4
        block.push({
          color: "#0077d3",
          x: 5,
          y: -3,
        });

        move();
      }

      function addZShape() {
        block = [];

        // #1
        block.push({
          color: "#53da3f",
          x: 3,
          y: -1,
        });

        // #2
        block.push({
          color: "#53da3f",
          x: 4,
          y: -1,
        });

        // #3
        block.push({
          color: "#53da3f",
          x: 4,
          y: -2,
        });

        // #4
        block.push({
          color: "#53da3f",
          x: 5,
          y: -2,
        });

        move();
      }

      function addTShape() {
        block = [];

        // #1
        block.push({
          color: "#f000ff",
          x: 4,
          y: -1,
        });

        // #2
        block.push({
          color: "#f000ff",
          x: 4,
          y: -2,
        });

        // #3
        block.push({
          color: "#f000ff",
          x: 5,
          y: -2,
        });

        // #4
        block.push({
          color: "#f000ff",
          x: 4,
          y: -3,
        });

        move();
      }
    
      function play() {
        switch (Math.floor(Math.random() * 6)) {
            case 0: addLineShape(); break;
            case 1: addSquareShape(); break;
            case 2: addLShape(); break;
            case 3: addMirrorLShape(); break;
            case 4: addZShape(); break;
            case 5: addTShape(); break;
        }
      }
    </script>
  </body>
</html>
